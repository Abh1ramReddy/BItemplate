fileVersion: 1
id: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
name: MRT_REPORTING__GOOGLE_ADS_KEYWORD_STATS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: ANALYTICS_REPORTING
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48a75b0b-d6f6-43a7-8a15-b1b7bfb7080f
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afef594d-a01b-49df-9927-56ace8c5d7d1
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff18c841-2b6a-422e-bb70-87eea6cb6c79
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: DATE
        description: ""
        name: DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 063f7808-9596-4649-bf41-c09c7ad2ab36
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b2f696f-d792-42e2-80a8-67bdd957e2b8
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CAMPAIGN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8231bddc-12f3-4a07-a3b0-1f0d58c02e05
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: REPLACE(REPLACE(campaign_name,'-Kampagne'),' Kampagne')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29129ed9-772a-47bd-b70a-fb40b088a0ce
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: FLOAT
        description: ""
        name: CONVERSIONS_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe2a51bf-f4d5-4114-ae1c-c49932670328
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b75bac29-bb05-4aaf-b3cb-3f7eb6327e52
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: AD_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1ebb1da-e95a-4e05-b36a-44ba7c9eac28
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46370236-54a9-4936-b8d8-62ef3477037e
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: FLOAT
        description: ""
        name: CONVERSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c2d615a-f44b-46f9-9e4f-636f442ced20
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcda2891-6122-4f3d-9f72-d92a5f47b26a
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: INTERACTIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fc712f5-1633-4e62-85e3-b7bf0cbd2560
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77dcb3be-399d-49ea-8f78-d03acf06878b
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: KEYWORD_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab7e624-6e98-4da6-96a5-a9435dc22cb2
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aedca56e-1dad-40aa-9ef0-068d99be0a54
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: FLOAT
        description: ""
        name: INTERACTION_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15872ca6-a063-496c-b228-5116130338bf
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5d29613-5f77-47ec-b4c8-907d8ad3d2a9
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: IMPRESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 359eab58-defc-4049-9351-f5ea6e1d2363
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2fbcac0-43a0-46b4-a949-ec0ea8c80dc9
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: FLOAT
        description: ""
        name: AVERAGE_CPC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71c670ce-3b19-405f-aaec-8d50a0881247
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95a05736-9032-4a06-8e24-60d1debedc4e
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02644039-c0c4-4e51-9e77-4218310f8780
                stepCounter: bc21e5e7-f36c-4144-9348-3a093748669e
            transform: cost_micros / 1000000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1adfe0b5-051e-4f62-9a95-8861cd6cf4c1
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da43c55-e4f2-444c-a83d-23439fbf6324
                stepCounter: 571f0cbd-12dc-4f40-a90f-3a123bf86ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c917455-7034-4eaf-8442-2cac63fd80e4
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ACCOUNT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 138080c1-c48c-4236-9727-46d878b411fd
                stepCounter: 571f0cbd-12dc-4f40-a90f-3a123bf86ae4
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2b5207f2-39e7-4152-81fa-05561692fa6e
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DISPLAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f53e781-0246-4642-affd-bf4792080d97
                stepCounter: 1a016e89-e870-4758-823b-8c57f0e20389
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac6115b-1cd7-417e-a924-fc6ca188970d
          stepCounter: d1926aa9-cd00-45ba-b41f-32d2689fb0f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: HOTELGRUPPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5a4d0d4-b8c3-4bc5-816f-b05a71edb78e
                stepCounter: 1a016e89-e870-4758-823b-8c57f0e20389
            transform: ""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_GOOGLE_ADS__ACCOUNT_HISTORY: 571f0cbd-12dc-4f40-a90f-3a123bf86ae4
          STG_GOOGLE_ADS__KEYWORD_LEVEL: bc21e5e7-f36c-4144-9348-3a093748669e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STG_ACCOUNT_MAPPING
            nodeName: STG_GADS_ACCOUNT_MAPPING
          - locationName: STG_GOOGLE_ADS
            nodeName: STG_GOOGLE_ADS__ACCOUNT_HISTORY
          - locationName: STG_GOOGLE_ADS
            nodeName: STG_GOOGLE_ADS__KEYWORD_LEVEL
        join:
          joinCondition: |-
            FROM {{ ref('STG_GOOGLE_ADS', 'STG_GOOGLE_ADS__KEYWORD_LEVEL') }} "STG_GOOGLE_ADS__KEYWORD_LEVEL"
            LEFT JOIN {{ ref('STG_GOOGLE_ADS', 'STG_GOOGLE_ADS__ACCOUNT_HISTORY') }} "STG_GOOGLE_ADS__ACCOUNT_HISTORY"
            ON "STG_GOOGLE_ADS__KEYWORD_LEVEL".CUSTOMER_ID = "STG_GOOGLE_ADS__ACCOUNT_HISTORY".ID
            LEFT JOIN (SELECT "NAME","DISPLAY_NAME", "HOTELGRUPPE" FROM {{ ref('STG_ACCOUNT_MAPPING', 'STG_GADS_ACCOUNT_MAPPING') }}) "STG_GADS_ACCOUNT_MAPPING"
            ON "STG_GOOGLE_ADS__ACCOUNT_HISTORY"."NAME"="STG_GADS_ACCOUNT_MAPPING"."NAME"
        name: MRT_REPORTING__GOOGLE_ADS_KEYWORD_STATS
        noLinkRefs: []
  name: MRT_REPORTING__GOOGLE_ADS_KEYWORD_STATS
  overrideSQL: false
  schema: ""
  sqlType: "5"
  type: sql
  version: 1
type: Node
