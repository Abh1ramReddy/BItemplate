fileVersion: 1
id: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
name: MRT_REPORTING__FBADS_REGION
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: ANALYTICS_REPORTING
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02747f3b-5330-425d-a74e-8187cda12ee5
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ACCOUNT_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24a2eb61-efec-4a62-a6b2-b9aac5b459f0
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13c13c12-f084-4ac1-9942-d27b3d2d243c
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: DATE
        description: ""
        name: DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6303054-50af-4724-a93a-9082171c43d2
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d6dddfc-e261-4347-be0e-0deab9f9a00f
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: _FIVETRAN_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad8226bd-d035-4836-9441-e10a5b7281c0
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2e66743-b6c0-41b8-9cd3-da7775be9604
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d7d8952-e6ce-421d-9e8e-9d7dfded3f8c
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5a13933-94c3-419d-9969-ca4b8d00ba1b
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: IMPRESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f804aabd-c83e-4532-994c-01b296f34418
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92cbacdd-94d5-4125-a1b2-189c4a667b4c
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: INLINE_LINK_CLICKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c705208-3d58-4cff-9027-d405b22424fa
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52e173e0-1df4-4605-8502-ec4a4f43f8e7
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e8a1406-a612-476d-911e-9080b9b9cbd5
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72c7235d-4297-4f3b-a843-886d8153617d
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: FLOAT
        description: ""
        name: COST_PER_INLINE_LINK_CLICK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01ee7982-0a39-401a-94ec-b526d933bb69
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 519cac74-d209-4c72-ab27-e68175610565
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: FLOAT
        description: ""
        name: CPC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf4b018-4a64-4c1f-8494-1eb4f0c0c2bf
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fabc57f4-c778-40f9-bcdf-a15e779b56a6
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: FLOAT
        description: ""
        name: CPM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 695b36cf-8422-4c6f-acff-8b86a0b351c8
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6620a3f8-23fc-4fec-8c6b-e920e93f7068
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: FLOAT
        description: ""
        name: CTR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36d2e861-4f31-483a-94b7-6249c764f1fc
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dfc4904-e7b2-4195-b57f-24f88ccba68b
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: FLOAT
        description: ""
        name: FREQUENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbfd925b-88c1-45bf-9227-1bf3f3a7f627
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75bc95e6-94ad-4629-a04b-579849131085
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: FLOAT
        description: ""
        name: SPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a0cb4bf-8ad5-46de-8547-06e38b2cf7a5
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0a80832-81f8-4b02-9d23-ae5203eccaab
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: INLINE_LINK_CLICK_CTR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcac4cf1-dd1b-4cce-ab26-11c754ea96d1
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61d1d9fa-19e2-4772-bb6f-f2080eddb298
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be927ba1-e448-4ebe-99d9-85dc67d3b272
                stepCounter: fbc49565-aa09-4847-9948-391c5ac20a1c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e572ad73-54f0-4c1f-aa63-fd28282bf9be
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a073dba-8acb-4266-b287-1aa61acd7976
                stepCounter: 66c05d14-0ef0-425b-9673-38b1bd401739
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae21336f-7543-46fa-9efe-da9f99226236
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ACCOUNT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 817ceb9d-310a-473f-80de-41097a3e4fe5
                stepCounter: 66c05d14-0ef0-425b-9673-38b1bd401739
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2b9a194a-6d48-4d32-a10d-b85d46b46ca0
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DISPLAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a16325f7-c678-4509-a7ad-20f1dad5e9d9
                stepCounter: abeb00e0-8c73-4841-86f2-6ca1928da0ac
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e3457965-fa40-45f7-96e3-d68bfd0607c3
          stepCounter: e592e7af-a9d6-4d05-bab9-82f34c65f3cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: HOTELGRUPPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fbac4e5-14dd-4220-83a5-5934970037a6
                stepCounter: abeb00e0-8c73-4841-86f2-6ca1928da0ac
            transform: ""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_ACCOUNT_HISTORY: 66c05d14-0ef0-425b-9673-38b1bd401739
          STG_DEMOGRAPHICS_REGION: fbc49565-aa09-4847-9948-391c5ac20a1c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STG_ACCOUNT_MAPPING
            nodeName: STG_FBADS_ACCOUNT_MAPPING
          - locationName: STG_FACEBOOK_ADS
            nodeName: STG_ACCOUNT_HISTORY
          - locationName: STG_FACEBOOK_ADS
            nodeName: STG_DEMOGRAPHICS_REGION
        join:
          joinCondition: |
            FROM {{ ref('STG_FACEBOOK_ADS', 'STG_DEMOGRAPHICS_REGION') }} "STG_DEMOGRAPHICS_REGION"
            LEFT JOIN {{ ref('STG_FACEBOOK_ADS', 'STG_ACCOUNT_HISTORY') }} "STG_ACCOUNT_HISTORY"
            ON "STG_DEMOGRAPHICS_REGION"."ACCOUNT_ID" = "STG_ACCOUNT_HISTORY"."ID"

            LEFT JOIN (SELECT "NAME","DISPLAY_NAME", "HOTELGRUPPE" FROM {{ ref('STG_ACCOUNT_MAPPING', 'STG_FBADS_ACCOUNT_MAPPING') }}) "STG_FBADS_ACCOUNT_MAPPING"
            ON "STG_ACCOUNT_HISTORY"."NAME"="STG_FBADS_ACCOUNT_MAPPING"."NAME"
        name: MRT_REPORTING__FBADS_REGION
        noLinkRefs: []
  name: MRT_REPORTING__FBADS_REGION
  overrideSQL: false
  schema: ""
  sqlType: "5"
  type: sql
  version: 1
type: Node
