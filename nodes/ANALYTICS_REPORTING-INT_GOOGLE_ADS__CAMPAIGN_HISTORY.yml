fileVersion: 1
id: aaedcde8-8055-414c-8e27-9968c5ebaea3
name: INT_GOOGLE_ADS__CAMPAIGN_HISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: ANALYTICS_REPORTING
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34951c1b-8a53-4f2b-a519-074637a0a448
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8851aa07-c4e8-4f59-aac1-06b192adb098
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceb37c30-1c56-4947-b87a-7de6e1012248
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20a05f83-2d12-4790-a206-26b23d596945
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed13984-cfa7-4482-b5da-4544b1cee901
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60a788da-20e0-4ec3-b1c3-032f812c8faf
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8170ec8-0547-4a01-a6b1-2568dbce2b96
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: BASE_CAMPAIGN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6d32976-a969-4c00-8d4d-639bbc0f9b12
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a49206a-f46e-471a-8db8-f250639f47e8
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: AD_SERVING_OPTIMIZATION_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65a74f42-a042-4f60-b2dc-306681d30ad7
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6895402-bdb0-4950-b6f0-28acd8a8c8fb
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADVERTISING_CHANNEL_SUBTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01d2a0f2-debc-415f-b24d-f9dd7cf42e77
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e7cf720-ea31-491d-af32-84126b63bd83
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADVERTISING_CHANNEL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94a23d2e-522e-4e11-8073-069286ccf089
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c40a0ba-357e-4633-bb41-62f0b1c67d83
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: EXPERIMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6023eafe-61bb-41bc-aaae-cb3a5f5c64d8
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c14b3c1d-201f-48ee-8a89-7565ea9fdec2
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1822464-f5e4-4347-845f-de0437261461
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa159678-f3e5-40b9-a226-15562931a67c
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: FINAL_URL_SUFFIX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97bc195a-4e3c-4b25-8e90-3d9003e680c1
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a79bfdca-e292-4f8c-88cb-d527be74c0c7
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: FREQUENCY_CAPS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e322d4af-dfe1-4aa5-9ee1-4f8cf82a2a62
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6fbe002-c190-43b7-be08-59f96f0d9178
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb949a4c-acd3-49b6-b50a-a4cbd87431d2
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f34e89c9-2c06-4c11-bc3b-8759295d5d41
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: FLOAT
        description: ""
        name: OPTIMIZATION_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f89ea14-3987-4ebe-b519-d7bb06c1f861
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad4e4693-e737-4758-9ca6-bf16d241f0fb
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PAYMENT_MODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ff27d97-4eee-4c3b-b18e-73eb25c6a795
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfc3d7e5-9bc1-42ad-b54f-54a2aa48b958
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SERVING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cccdfdfd-7593-485d-9413-3d4c430d79bc
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 551e924f-3f18-45ce-a4b4-c2cea1b34518
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ffeef76-6f79-4407-b7b6-2666f3347c6a
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f16554a3-4757-4247-a0b3-bc82392dd56d
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aa60254-9f48-418a-a7d1-8f1d777f7f61
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c77d156-d008-41db-bb53-7122b75d2cc0
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: TRACKING_URL_TEMPLATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 110b1ebb-bcc8-405c-9495-8c876be5a115
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03a26e32-1f71-4b37-9187-d2b71acdca9e
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VANITY_PHARMA_DISPLAY_URL_MODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67568856-00a4-4bac-9076-5773d7a23b3c
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508435f6-7136-47cf-9f68-2e8e9ee409d1
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VANITY_PHARMA_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 602635cc-3ebf-4e58-b428-db5ef03e2d39
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8cd0d83-5c56-41d0-9fc8-e6be54728a65
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VIDEO_BRAND_SAFETY_SUITABILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8013e86-513d-4918-8578-c1d9feffc570
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbd8a895-6a8f-49c9-bc65-a2e1bbd9b14d
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55c4aed4-b37b-4676-ae2f-3ecae8e56142
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 674c56c8-8d1c-44a2-bacd-1590d42943d5
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_START
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af59533d-bbbd-4f46-8808-642d1faa5207
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55053ad3-5287-4e67-b4c7-514a447aac59
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 266dfd53-eb21-4c89-a9fa-05a08801eaed
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd749019-57d8-473d-988a-202c19996497
          stepCounter: aaedcde8-8055-414c-8e27-9968c5ebaea3
        config: {}
        dataType: BOOLEAN
        description: ""
        name: _FIVETRAN_ACTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0e1f9b0-9c96-4191-9e60-c8a068f5139d
                stepCounter: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_GOOGLE_ADS__CAMPAIGN_HISTORY: 5ea66a92-913d-48d2-a1f3-23e7e5b68e1f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STG_GOOGLE_ADS
            nodeName: STG_GOOGLE_ADS__CAMPAIGN_HISTORY
        join:
          joinCondition: |-
            FROM {{ ref('STG_GOOGLE_ADS', 'STG_GOOGLE_ADS__CAMPAIGN_HISTORY') }} "STG_GOOGLE_ADS__CAMPAIGN_HISTORY"
            qualify row_number() over (partition by base_campaign_id order by updated_at desc) = 1
        name: INT_GOOGLE_ADS__CAMPAIGN_HISTORY
        noLinkRefs: []
  name: INT_GOOGLE_ADS__CAMPAIGN_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: "2"
  type: sql
  version: 1
type: Node
