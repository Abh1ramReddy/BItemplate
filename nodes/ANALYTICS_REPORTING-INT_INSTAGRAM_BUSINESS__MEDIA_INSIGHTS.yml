fileVersion: 1
id: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
name: INT_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: ANALYTICS_REPORTING
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e3759598-9a0e-4ea7-bdcd-b97a0352ebf4
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: _FIVETRAN_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27d6e75a-d75d-406c-b0db-ea48f642006d
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: a9c0e101-bf9f-4dcd-a353-8803fae23b96
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97eeac31-6f9f-41ad-96f3-868c26da7d76
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e09883bc-d8e1-4288-a7e9-29868cdf3fdc
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LIKE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29027d54-28e2-4d7d-9e9e-134f47e2810c
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: fd602698-5484-40d0-aea5-c3d351ede879
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: COMMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6dd5c35-f936-4fea-b143-3fe93d1aee04
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: dd8afa6e-83f5-4a9a-936b-1411834bc164
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VIDEO_PHOTO_IMPRESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 540fe1de-3395-4d3d-bcf0-5a186e0ad3e8
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 9c4d2451-428c-4de5-8a03-c505228d72c9
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VIDEO_PHOTO_REACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c5d2296-c236-406f-a20b-ad9ec4c966a0
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 86f66ce8-37ba-4ea4-9197-39cbbbe57962
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VIDEO_PHOTO_SAVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e78a633-8393-4219-b330-820320df1691
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 8391ecbc-441a-47e3-90b9-ce333ac16421
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VIDEO_VIEWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b919816-e252-4d14-9492-f0ab86bce424
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e9094f70-30ed-488c-b631-02eceee56b50
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CAROUSEL_ALBUM_ENGAGEMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb08680b-a5cd-4f31-86a2-9eb24a07f698
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 859e3fe2-7fcf-4435-a7eb-98dfaa1fa45f
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CAROUSEL_ALBUM_IMPRESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fbe3429-04f1-4715-9c66-7053ebf5e4dc
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c583c10a-a820-4dcd-883b-500154bfaa40
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CAROUSEL_ALBUM_REACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fecd5aaa-de16-4e9d-a6d3-914f27fa3f90
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: d4303750-0fa3-4894-9558-f38527cf4525
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CAROUSEL_ALBUM_SAVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a88e55fd-f27b-4669-b4ac-9e8a0d1c8190
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: b2d97dd4-bab8-4a03-9b98-9116ca4790e2
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CAROUSEL_ALBUM_VIDEO_VIEWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6eff3ec2-eb00-4562-9e7e-44b9d1ae2180
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 63c8e1cc-9dd6-4ba0-9462-3024267f131e
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_IMPRESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab233df4-80de-442e-9feb-f31dea3fe570
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c2ff0f3d-8ba2-4ffd-a900-4d048b963417
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_REACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 845c75a5-4776-4673-883a-74f657977b91
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 78310a89-689f-4dfd-8f78-96e64926fb24
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: NAVIGATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7be38517-0a5c-4fd3-9f1b-c3121e6f8456
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: faacb9bf-7411-4828-a331-6d98aece14e1
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_REACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7247d55-f9dd-47b8-a320-04598fab8d09
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 49955aec-d508-4b49-8b61-92dc6e329b4e
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_SAVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc5f5266-12a4-42f6-933c-1fa2fa8265d1
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: ca616e67-1726-4411-a9e7-c5f73a302aae
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VIDEO_PHOTO_ENGAGEMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b5d492b-eb0d-4c6d-b014-2f97a5e2ddb1
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 1b9cbb2b-84b4-4e64-81a6-1ecec325cef4
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_EXITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363da9aa-5119-4c4b-ae3e-05a43a3403d6
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 05327f69-7607-4557-beae-b57c0b6a5a6d
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_REPLIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 352a6b7b-fd50-4ae8-856d-e61c92f7ef3d
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: cfffc282-e529-4c91-ba75-74c90b75ac9e
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_TAPS_BACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bfbf4c6-1373-408b-8e22-e4b8f5a494f8
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: a7bd9662-bfab-4496-bfbc-d97bf5d55930
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_TAPS_FORWARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9ea82e0-a34e-436b-b2fb-fcca334d875c
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 2bdaf536-949d-4f9b-8862-06fc0dc81e8e
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: STORY_SWIPE_FORWARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a0b2981-70f5-404a-ab90-5a9dfb44d7df
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 51f46c3b-c821-4f2c-8f26-3b39002402fe
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_AGGREGATED_ALL_PLAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 561f8893-c38c-4d3d-8649-165f2bd5ba8a
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e569adf1-d5ee-4e4f-b577-df9ebec305f7
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_CLIPS_REPLAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8abdfc7-247d-4266-a2c5-610eb79d9f02
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 31755db0-3f5e-48fb-968d-f398b2a9fdf8
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d1a76fc-4e9a-4964-9887-f98348ccc949
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: a74c288d-4b0b-413e-9150-cfd6c15e2e26
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_LIKES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25aa1d48-c73f-4585-96e3-34cff7ede2b1
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 1d2d02f0-0e79-41f7-bfbc-6648e4479922
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_PLAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d33c8b6-9141-4902-a307-4123d4b91b0a
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 3cabf676-8a2a-4bce-ab6a-3aae338af4fb
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_SHARES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57db0ea7-6f06-4ddb-9a88-c5e6f9b1e612
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 1fbfe4b1-ccac-41b2-b81e-89f8e01ca7e3
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REEL_TOTAL_INTERACTIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49b067f7-64b8-4630-b40e-1f7ff47eb6d2
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: f4d68bae-053f-40b0-b831-5055e7a56eb1
          stepCounter: 204b7ee7-3e5b-45d4-81d2-e3fe14d5fd83
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a70683e3-8976-4db8-b4f5-61f8039ed29e
                stepCounter: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
            transform: ""
    cteString: ""
    enabledColumnTestIDs:
      - isDistinct
      - hasNull
    sourceMapping:
      - aliases:
          STG_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS: 74b99bbd-ad72-43cc-8ff4-d92bedc1b183
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STG_INSTAGRAM_BUSINESS
            nodeName: STG_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS
        join:
          joinCondition: |-
            FROM {{ ref('STG_INSTAGRAM_BUSINESS', 'STG_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS') }} "STG_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS"
            qualify ROW_NUMBER() over (partition by "STG_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS"."ID" order by "STG_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS"."LIKE_COUNT" desc) = 1
        name: INT_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS
        noLinkRefs: []
  name: INT_INSTAGRAM_BUSINESS__MEDIA_INSIGHTS
  overrideSQL: false
  schema: ""
  sqlType: "2"
  type: sql
  version: 1
type: Node
