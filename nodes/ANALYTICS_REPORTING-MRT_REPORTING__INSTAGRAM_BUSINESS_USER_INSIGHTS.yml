fileVersion: 1
id: 8c4496e1-6305-40af-99ab-9f9af382dcb3
name: MRT_REPORTING__INSTAGRAM_BUSINESS_USER_INSIGHTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: ANALYTICS_REPORTING
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7f0243b-2dcf-428f-a7c9-9318537eabb2
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48654089-a778-4920-a2da-c13718a1e58a
                stepCounter: e6487322-37dc-4418-9c8e-7fba2d73985e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c9bdfac-b274-449a-a1d6-133c1e18f6ff
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c784d66b-9e63-475e-abc8-85d4ea4186ac
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5edc9dff-bf8f-4b55-826f-48751deca7c8
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: DATE
        description: ""
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af11232-3097-4284-b90e-a8aa77214146
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eccf087f-6589-4248-9a18-989a7d1e3b7c
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EMAIL_CONTACTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f216453-b09b-4c0d-8584-2fe6b96e6d06
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6844122-7816-4a8a-82dd-90a20c69dbce
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: FOLLOWER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7635c9b-8410-4abb-808a-87f1c16117c1
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: coalesce(follower_count, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8b44637-a7a6-48b3-82d1-ecb2a7c7463a
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PHONE_CALL_CLICKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceab3e30-3b35-4cac-8fae-ac18ba962139
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15c94915-53f4-46c7-aaad-64e3bdfd3ca9
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROFILE_VIEWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2389a34-c7fd-446a-b106-978b85f8f55b
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a67f06e1-85f5-44b7-a740-a6ecfa645fc3
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TEXT_MESSAGE_CLICKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2aebaa1-a11f-4edb-9513-13473140a6b7
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383ee966-20a1-4de9-9c69-bb7c5798e682
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: WEBSITE_CLICKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 612081ad-cc10-42c2-b6f1-2c04892faa76
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca83dd67-e108-407c-a74d-b0ddf27bc61d
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: IMPRESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 492cd9a8-6bd1-4d5e-9394-356233a0eadf
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b0fbf42-0f31-47c9-aed6-5796fcffa5dc
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: IMPRESSIONS_7_D
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a317f3f-6105-41b4-9804-f84918cd3bce
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e0e0e0-3019-4b42-bdc3-06fc14a0b903
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: IMPRESSIONS_28_D
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ffb5bc6-81e2-4817-8e52-f96b0255c621
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2718f674-2975-4642-a902-423beda75227
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa916a71-c0cf-461a-9291-76f92b627a7f
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f49610c8-6824-4034-bc1e-c1566cb38f08
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REACH_7_D
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ad4b1d2-3d19-4b0d-81a7-5fe37f82082f
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a8b857-ad2a-46a9-bf4e-f2d5ee23a4d0
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REACH_28_D
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9a4ef78-e3a1-4d10-906e-d30b75e9a2a4
                stepCounter: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 76458547-830a-454b-83d9-a4fff924d386
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DISPLAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c745849-25ae-47c4-a27a-b137e2b903b8
                stepCounter: 057024d5-e625-4ba4-a8bb-6c55feb8ff99
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9782ba94-b7fa-4ddc-acd8-ddb22869c493
          stepCounter: 8c4496e1-6305-40af-99ab-9f9af382dcb3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: HOTELGRUPPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60f62d9b-a782-452a-b505-8da6b4655553
                stepCounter: 057024d5-e625-4ba4-a8bb-6c55feb8ff99
            transform: ""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          INT_INSTAGRAM_BUSINESS__UNIQUE_USER: e6487322-37dc-4418-9c8e-7fba2d73985e
          STG_INSTAGRAM_BUSINESS__USER_INSIGHTS: 4f1ccc77-cd26-40bc-bd13-f58a3e9054b2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: ANALYTICS_REPORTING
            nodeName: INT_INSTAGRAM_BUSINESS__UNIQUE_USER
          - locationName: STG_ACCOUNT_MAPPING
            nodeName: STG_INSTAGRAM_ACCOUNT_MAPPING
          - locationName: STG_INSTAGRAM_BUSINESS
            nodeName: STG_INSTAGRAM_BUSINESS__USER_INSIGHTS
        join:
          joinCondition: |-
            FROM {{ ref('ANALYTICS_REPORTING', 'INT_INSTAGRAM_BUSINESS__UNIQUE_USER') }} "INT_INSTAGRAM_BUSINESS__UNIQUE_USER"
            LEFT JOIN {{ ref('STG_INSTAGRAM_BUSINESS', 'STG_INSTAGRAM_BUSINESS__USER_INSIGHTS') }} "STG_INSTAGRAM_BUSINESS__USER_INSIGHTS"
            ON "INT_INSTAGRAM_BUSINESS__UNIQUE_USER".ID = "STG_INSTAGRAM_BUSINESS__USER_INSIGHTS".ID
            LEFT JOIN (SELECT "NAME","DISPLAY_NAME", "HOTELGRUPPE" FROM {{ ref('STG_ACCOUNT_MAPPING', 'STG_INSTAGRAM_ACCOUNT_MAPPING') }}) "STG_INSTAGRAM_ACCOUNT_MAPPING"
            ON "INT_INSTAGRAM_BUSINESS__UNIQUE_USER"."NAME"="STG_INSTAGRAM_ACCOUNT_MAPPING"."NAME"
        name: MRT_REPORTING__INSTAGRAM_BUSINESS_USER_INSIGHTS
        noLinkRefs: []
  name: MRT_REPORTING__INSTAGRAM_BUSINESS_USER_INSIGHTS
  overrideSQL: false
  schema: ""
  sqlType: "5"
  type: sql
  version: 1
type: Node
